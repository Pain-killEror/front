<!-- dead-dashboard.html --> 
<!--
Это HTML-фрагмент, который описывает структуру панели сотрудника деканата.
Он будет загружен в <main id="dashboard-content"> на главной странице.
-->

<!-- Панель с фильтрами -->
<div class="dashboard-filters" style="display: flex; align-items: center; gap: 1rem;">
    <!-- Просто надпись с названием факультета -->
    <h2 style="margin: 0; font-size: 1.5rem; color: #333;">
        <span id="dean-faculty-name" style="color: #007bff;">Загрузка...</span>
    </h2>
</div>

<!-- Сетка для размещения виджетов -->
<div id="dashboard-grid-dean" class="dashboard-grid-dean">

    <!-- Виджет 1: Общий рейтинг студентов (таблица) -->
    <div id="widget-ranking-table" class="widget full-width">
    
    <!-- Панель с фильтрами и поиском -->
    <div class="ranking-controls">
        <h3>Общий рейтинг студентов</h3>
        <div class="filters">
            <label for="course-filter">Курс:</label>
            <select id="course-filter">
                <option value="1">1 курс</option>
                <option value="2">2 курс</option>
                <option value="3">3 курс</option>
                <option value="4">4 курс</option>
            </select>
            <input type="text" id="student-search-input" placeholder="Поиск по группе или студенту...">
        </div>
    </div>

    <!-- Контейнер, куда JS будет вставлять аккордеон с группами -->
    <div id="ranking-accordion-container">
        <!-- Загрузка... -->
    </div>
</div>

    

    <!-- Виджет 3: Распределение по успеваемости (гистограмма) -->
    <div id="widget-distribution-chart" class="widget">
        <h3>Распределение по успеваемости</h3>
        <!-- Сюда JS вставит canvas с графиком -->
    </div>

    <!-- Виджет 4: Вклад в рейтинг (круговая диаграмма) -->
    <!-- Виджет 4: Вклад в рейтинг (круговая диаграмма) -->
<div id="widget-contribution-chart" class="widget">
    <h3>Вклад в рейтинг</h3>
    <!-- Новый контейнер для графика и легенды -->
    <div class="chart-with-legend-container">
        <!-- Сюда JS вставит canvas с графиком -->
        <div id="contribution-chart-canvas-container"></div>
        <!-- Сюда JS вставит нашу кастомную легенду -->
        <div id="contribution-chart-legend" class="custom-legend"></div>
    </div>
</div>

</div>

<!-- Стили, специфичные для этой панели -->
<style>

        /* Стили для кнопки и селектора достижений */
    .add-achievement-btn {
        font-size: 1.5rem;
        cursor: pointer;
        color: #28a745;
        transition: transform 0.2s;
    }
    .add-achievement-btn:hover {
        transform: scale(1.2);
    }
    .achievement-select {
        display: none; /* Скрыт по умолчанию */
    }
    .achievement-select.active {
        display: inline-block; /* Показываем */
    }
    .achievement-added-icon {
        font-size: 1.5rem;
        color: #20c997;
    }
    /* конец стилей для кнопки и селектора достижений */

        /* Стили для панели управления рейтингом */
    .ranking-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }
    .ranking-controls .filters {
        display: flex;
        gap: 1rem;
        align-items: center;
    }
    .ranking-controls input, .ranking-controls select {
        padding: 0.5rem;
        border: 1px solid #ddd;
        border-radius: 4px;
    }

    /* Стили для аккордеона */
    .accordion-item .accordion-header {
        background-color: #f8f9fa;
        padding: 1rem;
        border: 1px solid #eee;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: bold;
    }
    .accordion-item .accordion-header:hover {
        background-color: #e9ecef;
    }
    .accordion-item .accordion-header::after {
        content: '▼';
        font-size: 0.8em;
        transition: transform 0.3s ease;
    }
    .accordion-item.open .accordion-header::after {
        transform: rotate(180deg);
    }

    .accordion-item .accordion-content {
        display: none; /* Скрыто по умолчанию */
        padding: 0;
        border: 1px solid #eee;
        border-top: none;
    }
    .accordion-item.open .accordion-content {
        display: block; /* Показываем при классе 'open' */
    }
    /* Стили для вложенной таблицы студентов */
    .student-table-wrapper {
        max-height: 400px;
        overflow-y: auto;
    }

     #ranking-accordion-container {
        max-height: 500px; /* Вы можете изменить это значение, например, на 60vh */
        overflow-y: auto;  /* Добавляет вертикальный скролл, если контент не помещается */
        border: 1px solid #eee; /* Добавляет рамку для визуального отделения */
    }

     /* конец стилей для панели управления рейтингом */

    /* для внеучебной активности */
    
        .chart-with-legend-container {
        display: flex;
        align-items: center;
        gap: 2rem; /* Расстояние между графиком и легендой */
    }

    #contribution-chart-canvas-container {
        position: relative;
        height: 250px;
        width: 250px;
    }

    .custom-legend {
        display: flex;
        flex-direction: column; /* Элементы в столбик */
        gap: 0.8rem; /* Расстояние между элементами легенды */
    }

    .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.9rem;
    }

    .legend-color-box {
        width: 15px;
        height: 15px;
        margin-right: 10px;
        border-radius: 3px;
    }

    /* конец стилей для внеучебной активности */

    .dashboard-grid-dean {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1.5rem;
    }

    .widget.full-width {
        grid-column: 1 / -1; /* Растягиваем на всю ширину */
    }

    .table-wrapper {
        max-height: 500px; /* Увеличим высоту для таблицы */
        overflow-y: auto;
    }

    #ranking-table-dean {
        width: 100%;
        border-collapse: collapse;
    }

    #ranking-table-dean th,
    #ranking-table-dean td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid #eee;
    }

    #ranking-table-dean th {
        background-color: #f8f9fa;
        position: sticky;
        top: 0;
    }
    
    .skeleton {
        background-color: #e0e0e0;
        border-radius: 4px;
        position: relative;
        overflow: hidden;
    }
</style>