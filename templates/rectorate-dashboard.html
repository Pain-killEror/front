<!-- templates/rectorate-dashboard.html -->

<!-- Сетка для размещения виджетов -->
<div id="dashboard-grid-rectorate" class="dashboard-grid-rectorate">

    <!-- Виджет 1: Сравнение успеваемости факультетов (гистограмма) -->
    <!-- Виджет 1: Сравнение успеваемости факультетов (СПИСОК) -->
    <div id="widget-faculty-performance" class="widget">
        <h3>Сравнение успеваемости</h3>
        <div class="widget-content-placeholder custom-scroll" style="height: auto; max-height: 400px; overflow-y: auto;">
            <!-- Сюда JS вставит список -->
            <div id="faculty-perf-list" class="perf-list"></div>
        </div>
    </div>

    <!-- НОВЫЙ ВИДЖЕТ: Центр отчетов -->
    <div id="widget-reports" class="widget">
        <h3>Центр отчетов</h3>
        <div class="reports-container">
            
            <!-- Блок 1: Отчет Администратора -->
            <div class="report-section">
                <h4>Общий отчет по системе (Администратор)</h4>
                <p class="report-desc">Статистика по пользователям и ролям.</p>
                <button id="btn-download-admin-report" class="action-btn" style="width: 100%;">
                    Скачать общий отчет
                </button>
            </div>

            <!-- Блок 2: Отчет Декана -->
            <div class="report-section">
                <h4>Отчет по успеваемости (Декан)</h4>
                <p class="report-desc">Детальный рейтинг студентов факультета.</p>
                <div class="report-form-group">
                    <select id="rector-report-faculty-select">
                        <option value="" disabled selected>Выберите факультет</option>
                        <!-- JS заполнит это -->
                    </select>
                    <select id="rector-report-course-select" style="margin-top: 5px;">
                        <option value="1">1 курс</option>
                        <option value="2">2 курс</option>
                        <option value="3">3 курс</option>
                        <option value="4">4 курс</option>
                    </select>
                    <button id="btn-download-dean-report" class="action-btn btn-approve" style="margin-top: 10px; width: 100%;">
                        Скачать отчет по факультету
                    </button>
                </div>
            </div>

        </div>
    </div>

    <div id="widget-key-metrics" class="widget">
        <h3>Общие показатели</h3>
        <div class="metrics-container">
            <!-- Карточка 1 -->
            <div class="metric-card metric-blue">
                <span class="metric-title">Всего студентов</span>
                <span id="metric-total-students" class="metric-value">...</span>
            </div>
            <!-- Карточка 2 -->
            <div class="metric-card metric-teal">
                <span class="metric-title">Средний балл (ВУЗ)</span>
                <span id="metric-avg-gpa" class="metric-value">...</span>
            </div>
            <!-- Карточка 3 -->
            <div class="metric-card metric-purple">
                <span class="metric-title">Внеучебные баллы</span>
                <span id="metric-total-points" class="metric-value">...</span>
            </div>
        </div>
    </div>

    <!-- Виджет 2: Распределение по формам обучения (круговая диаграмма) -->
    <div id="widget-education-form" class="widget">
        <h3>Распределение по формам обучения</h3>
        <div class="widget-content-placeholder">
            <!-- Сюда JS вставит canvas с графиком -->
        </div>
    </div>

    <!-- Виджет 3: Обзор внеучебной деятельности (сложенная гистограмма) -->
    <div id="widget-extracurricular-activity" class="widget full-width">
        <h3>Обзор внеучебной деятельности по факультетам</h3>
        <div class="widget-content-placeholder">
            <!-- Сюда JS вставит canvas с графиком -->
        </div>
    </div>

</div>

<!-- Стили, специфичные для этой панели -->
<style>
    .dashboard-grid-rectorate {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 1.5rem;
    }
    
    .widget.full-width {
        grid-column: 1 / -1; 
    }

    .widget-content-placeholder {
        min-height: 300px;
        position: relative;
    }

    /* Стили для списка успеваемости */
    .perf-list {
        display: flex;
        flex-direction: column;
        gap: 0;
    }
    .perf-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 10px; /* Чуть добавил отступы по бокам */
        border-bottom: 1px solid #f0f0f0; /* Более мягкая граница */
        transition: background-color 0.2s;
    }
    .perf-item:hover {
        background-color: #fafafa;
    }
    .perf-item:last-child {
        border-bottom: none;
    }
    .perf-name {
        font-weight: 500;
        color: #546e7a; /* Мягкий серо-синий цвет текста */
        font-size: 0.95rem;
    }
    
    /* --- МЯГКИЕ ЦВЕТА ДЛЯ ОЦЕНОК --- */
    .perf-value {
        font-weight: 600;
        font-size: 1rem;
        padding: 4px 12px;
        border-radius: 20px; /* Более округлые плашки */
        
        /* Дефолтный (средний) - Мягкий синий */
        color: #3949ab; 
        background: #e8eaf6; 
    }
    /* Высокий балл - Мягкий зеленый (Sage/Mint) */
    .perf-value.high { 
        color: #2e7d32; 
        background: #e8f5e9; 
    }
    /* Низкий балл - Мягкий красный (Coral/Pink) */
    .perf-value.low { 
        color: #c62828; 
        background: #ffebee; 
    }

    /* Стили для Центра отчетов */
    .reports-container {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    .report-section {
        background-color: #ffffff; /* Белый фон на серой подложке виджета смотрится чище */
        padding: 1.2rem;
        border-radius: 8px;
        border: 1px solid #eee;
        box-shadow: 0 2px 4px rgba(0,0,0,0.02);
    }
    .report-section h4 {
        margin: 0 0 0.5rem 0;
        font-size: 1rem;
        color: #455a64;
    }
    .report-desc {
        font-size: 0.85rem;
        color: #90a4ae;
        margin-bottom: 1rem;
    }
    .report-form-group select {
        width: 100%;
        padding: 0.6rem;
        border: 1px solid #cfd8dc;
        border-radius: 6px;
        background-color: #fff;
        color: #455a64;
    }
    
    /* Мягкие кнопки */
    .action-btn {
        padding: 0.6rem 1rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        background-color: #78909c; /* Мягкий серо-голубой */
        color: white;
        transition: background-color 0.2s, transform 0.1s;
    }
    .action-btn:hover { background-color: #607d8b; }
    .action-btn:active { transform: scale(0.98); }

    .btn-approve { background-color: #5c6bc0; /* Мягкий индиго */ }
    .btn-approve:hover { background-color: #3f51b5; }

    .custom-scroll::-webkit-scrollbar { width: 6px; }
    .custom-scroll::-webkit-scrollbar-thumb { background-color: #cfd8dc; border-radius: 3px; }

    /* --- НОВЫЕ СТИЛИ ДЛЯ КЛЮЧЕВЫХ ПОКАЗАТЕЛЕЙ (Мягкие цвета) --- */
    .metrics-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        /* Убрали height: 100% и justify-content: center */
        justify-content: flex-start; 
        margin-top: 0.5rem; /* Небольшой отступ от заголовка */
    }
    
    .metric-card {
        padding: 1.2rem 1.5rem; /* Немного уменьшил вертикальные отступы внутри карточки */
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.03);
    }
    .metric-title {
        font-size: 0.9rem;
        font-weight: 500;
        margin-bottom: 0.3rem; /* Уменьшил отступ между заголовком и цифрой */
        opacity: 0.8;
    }
    .metric-value {
        font-size: 2rem;
        font-weight: 700;
        line-height: 1.1; /* Убрал лишнюю высоту строки */
    }
    /* Цветовые темы карточек */
    .metric-blue { background-color: #e3f2fd; color: #1565c0; }   
    .metric-teal { background-color: #e0f2f1; color: #00695c; }   
    .metric-purple { background-color: #f3e5f5; color: #6a1b9a; } 

    .custom-scroll::-webkit-scrollbar { width: 6px; }
    .custom-scroll::-webkit-scrollbar-thumb { background-color: #cfd8dc; border-radius: 3px; }

    /* --- СТИЛИ ДЛЯ УВЕДОМЛЕНИЙ (TOAST) --- */
    .toast {
        min-width: 250px;
        padding: 15px 20px;
        border-radius: 6px;
        color: white;
        font-weight: 500;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease-in-out;
        margin-bottom: 10px;
    }
    .toast.show { opacity: 1; transform: translateX(0); }
    .toast.success { background-color: #28a745; }
    .toast.error { background-color: #dc3545; }
    .toast.info { background-color: #17a2b8; }
</style>